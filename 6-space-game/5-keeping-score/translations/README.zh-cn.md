# å»ºç«‹å¤ªç©ºæ¸¸æˆ Part 5ï¼šåˆ†æ•°ä¸ç”Ÿå‘½æ•°

## è¯¾å‰æµ‹éªŒ

[è¯¾å‰æµ‹éªŒ](https://ashy-river-0debb7803.1.azurestaticapps.net/quiz/37?loc=zh_tw)

åœ¨è¿™å ‚è¯¾ä¸­ï¼Œä½ ä¼šå­¦ä¹ å¦‚ä½•ä¸ºæ¸¸æˆåŠ å…¥è®¡åˆ†åŠŸèƒ½ä¸è®¡ç®—æ€§å‘½æ•°ã€‚

## åœ¨ç”»é¢ä¸Šç»˜åˆ¶æ–‡å­—

ä¸ºäº†åœ¨ç”»é¢ä¸Šæ˜¾ç¤ºæ¸¸æˆåˆ†æ•°ï¼Œä½ éœ€è¦äº†è§£å¦‚ä½•é…ç½®æ–‡å­—ã€‚ç­”æ¡ˆæ˜¯åœ¨ Canvas ç‰©ä»¶ä¸Šä½¿ç”¨æ–¹æ³• `fillText()`ã€‚ä½ ä¹Ÿå¯ä»¥æ§åˆ¶å…¶ä»–ç‰¹å¾ï¼Œä¾‹å¦‚æ–‡å­—å­—å‹ã€æ–‡å­—é¢œè‰²ç”šè‡³æ–‡å­—å¯¹é½æ–¹å‘(å·¦ã€å³ã€ç½®ä¸­)ã€‚ä¸‹é¢æ˜¯åœ¨ç”»é¢ä¸­ç»˜åˆ¶ä¸€äº›æ–‡å­—ã€‚

```javascript
ctx.font = "30px Arial";
ctx.fillStyle = "red";
ctx.textAlign = "right";
ctx.fillText("show this on the screen", 0, 0);
```

âœ… é˜…è¯»æ›´å¤šå…³äº[åœ¨ç”»å¸ƒä¸Šå»ºç«‹æ–‡å­—](https://developer.mozilla.org/docs/Web/API/Canvas_API/Tutorial/Drawing_text)ï¼Œä½ å¯ä»¥è‡ªç”±åœ°ä¸°å¯Œä½ çš„æ–‡å­—ï¼

## æ€§å‘½ï¼Œä¸€ä¸ªæ¸¸æˆæ¦‚å¿µ

æ¸¸æˆä¸­çš„ç”Ÿå‘½æ¦‚å¿µåªæ˜¯ä¸€ä¸ªæ•°å­—ã€‚åœ¨å¤ªç©ºæ¸¸æˆä¸­ï¼Œåœ¨ä½ çš„èˆ¹èˆ°å—åˆ°æ”»å‡»æ—¶ï¼Œæ‰£é™¤ç”Ÿå‘½å€¼æ˜¯ä¸€ç§å¸¸è§çš„æ–¹å¼ã€‚å¦‚æœèƒ½ä»¥å›¾åƒçš„æ–¹å¼æ˜¾ç¤ºç”Ÿå‘½å€¼ä¹Ÿæ˜¯å¾ˆå¥½çš„æ–¹å¼ï¼Œä¾‹å¦‚èˆ¹èˆ°å›¾ç¤ºã€å¿ƒè„å›¾åƒï¼Œè€Œéå•çº¯ä½¿ç”¨æ•°å­—ã€‚

## å»ºç«‹ç›®æ ‡

æˆ‘ä»¬åœ¨æ¸¸æˆä¸­æ–°å¢ä¸‹åˆ—åŠŸèƒ½ï¼š

- **æ¸¸æˆåˆ†æ•°**ï¼šå½“æ¯ä¸€è‰˜æ•Œå†›èˆ°è‰‡è¢«æ‘§æ¯æ—¶ï¼Œè‹±é›„åº”è¯¥å–å¾—ä¸€äº›å¥–åŠ±åˆ†æ•°ï¼Œæˆ‘ä»¬å»ºè®®ä¸€è‰˜æ•Œèˆ°ä¸€ç™¾åˆ†ã€‚æ¸¸æˆæ€»åˆ†åº”è¯¥æ˜¾ç¤ºåœ¨ç”»é¢çš„å·¦ä¸‹è§’ã€‚
- **ç”Ÿå‘½å€¼**ï¼šä½ çš„èˆ¹èˆ°æœ‰ä¸‰æ¡æ€§å‘½ã€‚åœ¨æ¯ä¸€æ¬¡æ•Œå†›èˆ°è‰‡æ’å‡»ä½ æ—¶ï¼Œä½ ä¼šæŸå¤±ä¸€æ¡æ€§å‘½ã€‚ç”Ÿå‘½æ•°åº”è¯¥æ˜¾ç¤ºåœ¨ç”»é¢çš„å³ä¸‹è§’ï¼Œä»¥ä¸‹åˆ—å›¾åƒæ˜¾ç¤ºå‡ºæ¥ã€‚ ![æ€§å‘½å›¾ç‰‡](../solution/assets/life.png)

## å»ºè®®æ­¥éª¤

åœ¨ä½ çš„ `your-work` å­èµ„æ–™å¤¹ä¸­ï¼Œç¡®è®¤æ¡£æ¡ˆæ˜¯å¦å»ºç«‹å®Œæˆã€‚å®ƒåº”è¯¥åŒ…æ‹¬ï¼š

```bash
-| assets
  -| enemyShip.png
  -| player.png
  -| laserRed.png
-| index.html
-| app.js
-| package.json
```

å¼€å§‹ `your_work` èµ„æ–™å¤¹ä¸­çš„ä¸“æ¡ˆï¼Œè¾“å…¥ï¼š

```bash
cd your-work
npm start
```

è¿™ä¼šå¯åŠ¨ HTTP ä¼ºæœå™¨å¹¶å‘å¸ƒç½‘å€ `http://localhost:5000`ã€‚å¼€å¯æµè§ˆå™¨å¹¶è¾“å…¥è¯¥ç½‘å€ï¼Œç°åœ¨å®ƒèƒ½æ˜¾ç¤ºå‡ºè‹±é›„ä¸æ‰€æœ‰çš„æ•Œäººï¼Œåœ¨ä½ æ“ä½œæ–¹å‘é”®åï¼Œè‹±é›„èƒ½ç§»åŠ¨å¹¶å‡»è½æ•Œäººã€‚

### åŠ å…¥ç¨‹å¼ç 

1. ä»èµ„æ–™å¤¹ `solution/assets/` **å¤åˆ¶ä½ éœ€è¦çš„æ¡£æ¡ˆ** åˆ°èµ„æ–™å¤¹ `your-work` ä¸­ã€‚ä½ ä¼šåŠ å…¥æ¡£æ¡ˆ `life.png`ã€‚åœ¨å‡½å¼ window.onload ä¸­åŠ å…¥ lifeImg ï¼š 

    ```javascript
    lifeImg = await loadTexture("assets/life.png");
    ```

1. åœ¨æ¡£æ¡ˆæ¸…å•ä¸­åŠ å…¥ `lifeImg`ï¼š

    ```javascript
    let heroImg,
    ...
    lifeImg,
    ...
    eventEmitter = new EventEmitter();
    ```
  
2. **æ–°å¢å˜æ•°**ã€‚ åŠ å…¥ç¨‹å¼ç è¡¨è¾¾ä½ çš„æ¸¸æˆæ€»åˆ†(0)å’Œå‰©é¦€æ€§å‘½(3)ï¼Œå¹¶æ˜¾ç¤ºåœ¨ç”»é¢ä¸Šã€‚

3. **æ‰©å¢å‡½å¼ `updateGameObjects()`**ã€‚ æ‰©å¢å‡½å¼ `updateGameObjects()` æ¥å¤„ç†æ•Œå†›ç¢°æ’ï¼š

    ```javascript
    enemies.forEach(enemy => {
        const heroRect = hero.rectFromGameObject();
        if (intersectRect(heroRect, enemy.rectFromGameObject())) {
          eventEmitter.emit(Messages.COLLISION_ENEMY_HERO, { enemy });
        }
      })
    ```

4. **åŠ å…¥ `life` ä¸ `points`**. 
   1. **åˆå§‹åŒ–å˜æ•°**ã€‚ åœ¨ `Hero` class çš„ `this.cooldown = 0` ä¸‹æ–¹ï¼Œè®¾å®šæ€§å‘½ä¸åˆ†æ•°ï¼š

        ```javascript
        this.life = 3;
        this.points = 0;
        ```

   1. **åœ¨ç”»é¢ä¸Šæ˜¾ç¤ºå˜æ•°å†…å®¹**ã€‚ åœ¨ç”»é¢ä¸Šç»˜åˆ¶è¿™äº›æ•°å€¼ï¼š

        ```javascript
        function drawLife() {
          // TODO, 35, 27
          const START_POS = canvas.width - 180;
          for(let i=0; i < hero.life; i++ ) {
            ctx.drawImage(
              lifeImg, 
              START_POS + (45 * (i+1) ), 
              canvas.height - 37);
          }
        }
        
        function drawPoints() {
          ctx.font = "30px Arial";
          ctx.fillStyle = "red";
          ctx.textAlign = "left";
          drawText("Points: " + hero.points, 10, canvas.height-20);
        }
        
        function drawText(message, x, y) {
          ctx.fillText(message, x, y);
        }

        ```

   1. **åœ¨æ¸¸æˆå›åœˆä¸­åŠ å…¥å‘¼å«**ã€‚ è¯·ç¡®ä¿ä½ åŠ å…¥è¿™äº›å‡½å¼åˆ° `updateGameObjects()` ä¸‹æ–¹çš„ window.onload å†…ï¼š

        ```javascript
        drawPoints();
        drawLife();
        ```

1. **åˆ¶å®šæ¸¸æˆè§„åˆ™**ã€‚ åˆ¶å®šä¸‹åˆ—çš„æ¸¸æˆè§„åˆ™ï¼š

   1. **åœ¨è‹±é›„ä¸æ•Œäººå‘ç”Ÿç¢°æ’æ—¶**ï¼Œæ‰£é™¤ä¸€æ¡ç”Ÿå‘½ã€‚
   
      æ‰©å¢ `Hero` class æ¥æ‰§è¡Œè¿™æ®µå‡æ³•ï¼š

        ```javascript
        decrementLife() {
          this.life--;
          if (this.life === 0) {
            this.dead = true;
          }
        }
        ```

   2. **å½“é›·å°„å‡»ä¸­æ•Œäººæ—¶**ï¼Œå¢åŠ æ¸¸æˆæ€»åˆ†ä¸€ç™¾åˆ†ã€‚

      æ‰©å¢ Hero class æ¥æ‰§è¡Œè¿™æ®µåŠ æ³•ï¼š
    
        ```javascript
          incrementPoints() {
            this.points += 100;
          }
        ```

        åŠ å…¥è¿™äº›å‡½å¼åˆ°ç¢°æ’äº‹ä»¶å‘é€å™¨ä¸­ï¼š

        ```javascript
        eventEmitter.on(Messages.COLLISION_ENEMY_LASER, (_, { first, second }) => {
           first.dead = true;
           second.dead = true;
           hero.incrementPoints();
        })

        eventEmitter.on(Messages.COLLISION_ENEMY_HERO, (_, { enemy }) => {
           enemy.dead = true;
           hero.decrementLife();
        });
        ```

âœ… åšç‚¹ç ”ç©¶ï¼Œæ¢ç´¢å…¶ä»–ä½¿ç”¨åˆ° JavaScript ä¸ Canvas çš„æ¸¸æˆã€‚ä»–ä»¬æœ‰ä»€ä¹ˆå…±åŒç‰¹å¾ï¼Ÿ

åœ¨è¿™ä¸ªå·¥ä½œçš„å°¾å£°ï¼Œä½ åº”è¯¥èƒ½åœ¨å³ä¸‹æ–¹çœ‹åˆ°ã€Œæ€§å‘½ã€å°èˆ¹ï¼›å·¦ä¸‹æ–¹çœ‹åˆ°æ¸¸æˆæ€»åˆ†ã€‚å½“ä½ ç¢°æ’åˆ°æ•Œäººæ—¶ä¼šæ‰£é™¤ç”Ÿå‘½ï¼›å½“ä½ å‡»è½æ•Œäººæ—¶ä¼šå¢åŠ åˆ†æ•°ã€‚åšå¾—å¥½ï¼ä½ çš„æ¸¸æˆå°±å¿«å®Œæˆäº†ã€‚

---

## ğŸš€ æŒ‘æˆ˜

ä½ çš„ç¨‹å¼å°±å¿«å®Œæˆäº†ã€‚ä½ èƒ½é¢„æµ‹åˆ°ä¸‹ä¸€æ­¥å—ï¼Ÿ

## è¯¾åæµ‹éªŒ

[è¯¾åæµ‹éªŒ](https://ashy-river-0debb7803.1.azurestaticapps.net/quiz/38?loc=zh_tw)

## å¤ä¹ ä¸è‡ªå­¦

ç ”ç©¶å…¶ä»–ç§å¢åŠ ä¸å‡å°‘åˆ†æ•°ä¸ç”Ÿå‘½æ•°çš„æ–¹æ³•ã€‚è¿™è¾¹æœ‰ä¸€äº›æœ‰è¶£çš„æ¸¸æˆå¼•æ“ï¼Œä¾‹å¦‚ï¼š[PlayFab](https://playfab.com)ã€‚ä½¿ç”¨è¿™äº›å¼•æ“èƒ½å¦‚ä½•å¢è¿›ä½ çš„æ¸¸æˆï¼Ÿ

## ä½œä¸š

[å»ºç«‹è®¡åˆ†æ¸¸æˆ](assignment.zh-tw.md)
